---
title: "STAT 632 Final Project Base Data Exploritory Analysis"
author: "Nic James"
date: "04/15/2020"
output:
  pdf_document: default
  word_document: default
  html_document: default
  html_notebook: default
---

# Project work

Running some preliminary analysis of the COVID-19 Data Hub data.

```{r}
library(pacman)
p_load(COVID19, tidyverse, ggplot2, dplyr, leaps, readr)
```

# Using the help function
```{r}
help("covid19")
```

# Create df:

US Data by State
```{r}
cacovid19data <- covid19("US", level = 2) %>% 
  filter(administrative_area_level_2 == "California", date >= "2020-03-15", date <= "2021-03-15")
head(cacovid19data)
tail(cacovid19data)
```
What are the names of all of the columns?
```{r}
names(cacovid19data)
```

## Create a new data frame

### What columns do I want for the base data set?

* "date"                               
* "tests"                              
* "confirmed"                          
* "recovered"                          
* "deaths"                             
* "hosp"                               
* "vent"                               
* "icu"                                
* "administrative_area_level_2"
* "administrative_area_level_3"
* "latitude"  
* "longitude"
* "population"
* "vaccines" 
* "school_closing"                     
* "workplace_closing"                  
* "cancel_events"                      
* "gatherings_restrictions"            
* "transport_closing"                  
* "stay_home_restrictions"             
* "internal_movement_restrictions"     
* "international_movement_restrictions"
* "information_campaigns"              
* "testing_policy"                     
* "contact_tracing"                    
* "stringency_index"

I don't have data for vaccines, tests, recovered, hosp, vent, and icu so we will remove these variables. 

Should we remove Longitude, Latitude, and population since the value is the same for every row?

```{r}
base_data <- subset(cacovid19data, select = c("date", "confirmed", "deaths", "administrative_area_level_2", "latitude"  , "longitude", "population",  "school_closing", "workplace_closing", "cancel_events", "gatherings_restrictions", "transport_closing", "stay_home_restrictions", "internal_movement_restrictions", "international_movement_restrictions", "information_campaigns", "testing_policy", "contact_tracing", "stringency_index"))

head(base_data)
```

All variables have data in every row now.

```{r}
summary(base_data)
```




```{r message=FALSE}
# region mobility report
library(readr)
region_mobility21 <- read_csv("2021_US_Region_Mobility_Report.csv")
region_mobility20 <- read_csv("2020_US_Region_Mobility_Report.csv")
region_mobility20.21 <- merge(x = region_mobility20, y = region_mobility21, all = T)
```

```{r}
# subset dataframe to CA, date range, omit NA
ca_mobility20.21 <- region_mobility20.21 %>% 
  filter(sub_region_1 == "California", date >= "2020-03-15", date <= "2021-03-15")
ca_mobility.col <- ca_mobility20.21[,-c(5:8)]
ca_mobility.dat <- na.omit(ca_mobility.col)
```

```{r}
# merge base_data and ca google mobility data
cacovid_mobility <- merge(x = ca_mobility.dat, y = base_data, all = T)
View(cacovid_mobility)
```




